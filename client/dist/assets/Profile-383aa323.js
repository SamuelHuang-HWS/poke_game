import{u as f,h as c,n as _,r as h,o as p,c as g,i as t,a as b,l as k,t as r,w as y,j as x,v as w,k as L}from"./vendor-7103c11f.js";import{_ as P,u as U}from"./index-714f4fbd.js";import"./utils-3f3b5d51.js";const N={name:"Profile",setup(){const v=f(),s=U(),n=c(null),e=c({totalGames:0,winRate:"0%"}),i=c({nickname:""}),d=c(!1);return _(async()=>{var o;try{await s.fetchUser(),n.value=s.user,i.value.nickname=((o=s.user)==null?void 0:o.nickname)||""}catch(a){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",a)}}),{user:n,stats:e,editForm:i,isLoading:d,handleUpdateProfile:async()=>{var o;try{d.value=!0;const a={};i.value.nickname!==(((o=n.value)==null?void 0:o.nickname)||"")&&(a.nickname=i.value.nickname),Object.keys(a).length>0&&(await s.updateUser(a),n.value=s.user,alert("èµ„æ–™æ›´æ–°æˆåŠŸ"))}catch(a){alert(a.message||"æ›´æ–°èµ„æ–™å¤±è´¥")}finally{d.value=!1}},handleLogout:()=>{confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ")&&(s.logout(),v.push("/login"))}}}},S={class:"profile-container"},V={class:"navbar glass-effect"},B={class:"nav-left"},C={class:"nav-right"},D={class:"profile-card glass-effect"},F={class:"avatar-section"},M={class:"username"},R={class:"stats-section"},j={class:"stat-item"},G={class:"stat-value"},T={class:"stat-item"},A={class:"stat-value"},E={class:"stat-item"},I={class:"stat-value"},O={class:"edit-section"},q={class:"form-group"},z=["disabled"];function H(v,s,n,e,i,d){var u,o,a;const m=h("router-link");return p(),g("div",S,[t("nav",V,[t("div",B,[b(m,{to:"/",class:"back-link"},{default:k(()=>[...s[3]||(s[3]=[L("â† è¿”å›é¦–é¡µ",-1)])]),_:1})]),s[4]||(s[4]=t("div",{class:"nav-center"},[t("h1",{class:"title"},"ä¸ªäººèµ„æ–™")],-1)),t("div",C,[t("button",{onClick:s[0]||(s[0]=(...l)=>e.handleLogout&&e.handleLogout(...l)),class:"logout-button"},"é€€å‡ºç™»å½•")])]),t("div",D,[t("div",F,[s[5]||(s[5]=t("div",{class:"avatar-placeholder"},"ğŸ‘¤",-1)),t("h2",M,r(((u=e.user)==null?void 0:u.nickname)||((o=e.user)==null?void 0:o.phoneNumber)),1)]),t("div",R,[t("div",j,[t("div",G,"ğŸ’° "+r(((a=e.user)==null?void 0:a.gold)||0),1),s[6]||(s[6]=t("div",{class:"stat-label"},"é‡‘å¸ä½™é¢",-1))]),t("div",T,[t("div",A,r(e.stats.totalGames||0),1),s[7]||(s[7]=t("div",{class:"stat-label"},"æ€»å±€æ•°",-1))]),t("div",E,[t("div",I,r(e.stats.winRate||"0%"),1),s[8]||(s[8]=t("div",{class:"stat-label"},"èƒœç‡",-1))])]),t("div",O,[s[10]||(s[10]=t("h3",{class:"section-title"},"ç¼–è¾‘èµ„æ–™",-1)),t("form",{onSubmit:s[2]||(s[2]=y((...l)=>e.handleUpdateProfile&&e.handleUpdateProfile(...l),["prevent"])),class:"edit-form"},[t("div",q,[s[9]||(s[9]=t("label",{class:"form-label"},"æ˜µç§°",-1)),x(t("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>e.editForm.nickname=l),type:"text",placeholder:"è¯·è¾“å…¥æ˜µç§°",class:"form-input",maxlength:"20"},null,512),[[w,e.editForm.nickname]])]),t("button",{type:"submit",class:"save-button",disabled:e.isLoading},r(e.isLoading?"ä¿å­˜ä¸­...":"ä¿å­˜ä¿®æ”¹"),9,z)],32)])])])}const W=P(N,[["render",H],["__scopeId","data-v-8e873b43"]]);export{W as default};
