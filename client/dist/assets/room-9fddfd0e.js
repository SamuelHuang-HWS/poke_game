import{d as n}from"./vendor-7103c11f.js";import{b as e}from"./index-714f4fbd.js";class c{async createRoom(r){return e.post("/rooms/create",r)}async searchRoom(r){return e.get(`/rooms/search/${r}`)}async joinRoom(r,a){return e.post("/rooms/join",{roomId:r,password:a})}async leaveRoom(r){return e.post(`/rooms/leave/${r}`)}async getRoomDetail(r){return e.get(`/rooms/${r}`)}async getUserRooms(){return e.get("/rooms/user/list")}async getUserActiveRooms(){return e.get("/rooms/user/active")}}const s=new c,m=n("room",{state:()=>({rooms:[],currentRoom:null,isLoading:!1,error:null}),getters:{myRooms:o=>o.rooms},actions:{async createRoom(o){try{this.isLoading=!0,this.error=null;const r=await s.createRoom(o);return this.currentRoom=r.data.data,r}catch(r){throw this.error=r.message||"创建房间失败",r}finally{this.isLoading=!1}},async searchRoom(o){try{return this.isLoading=!0,this.error=null,await s.searchRoom(o)}catch(r){throw this.error=r.message||"搜索房间失败",r}finally{this.isLoading=!1}},async joinRoom(o,r){var a,i;try{this.isLoading=!0,this.error=null;const t=await s.joinRoom(o,r);if((a=t==null?void 0:t.data)!=null&&a.data)return this.currentRoom=((i=t==null?void 0:t.data)==null?void 0:i.data)||"",t;throw this.error=t.message||"加入房间失败",error}catch(t){throw console.log(t),this.error=t.message||"加入房间失败",t}finally{this.isLoading=!1}},async leaveRoom(o){try{this.isLoading=!0,this.error=null;const r=await s.leaveRoom(o);return this.currentRoom=null,r}catch(r){throw this.error=r.message||"离开房间失败",r}finally{this.isLoading=!1}},async fetchRoomDetail(o){try{this.isLoading=!0,this.error=null;const r=await s.getRoomDetail(o);return this.currentRoom=r.data.data,r.data.data}catch(r){throw this.error=r.message||"获取房间详情失败",r}finally{this.isLoading=!1}},async fetchUserRooms(){try{this.isLoading=!0,this.error=null;const o=await s.getUserRooms();return this.rooms=o.data.data,o.data.data}catch(o){throw this.error=o.message||"获取房间列表失败",o}finally{this.isLoading=!1}},async fetchUserActiveRooms(){try{return this.isLoading=!0,this.error=null,(await s.getUserActiveRooms()).data.data}catch(o){throw this.error=o.message||"获取活跃房间列表失败",o}finally{this.isLoading=!1}}}});export{m as u};
